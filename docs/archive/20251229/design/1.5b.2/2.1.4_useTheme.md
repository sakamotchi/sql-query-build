# タスク1.5b.2.1.4: useTheme composable作成

**サブフェーズ**: 2.1 Composables・型定義
**工数**: 2.5時間
**優先度**: 高
**依存関係**: 2.1.1 (useEnvironment), 2.1.3 (型定義)

---

## 目的

テーマ（ライト/ダーク）とカラーモードの管理

---

## 実装内容

### ファイル作成: `app/composables/useTheme.ts`

```typescript
import type { ColorMode } from '~/types'

/**
 * テーマ管理Composable
 */
export const useTheme = () => {
  const colorMode = useColorMode()
  const { currentEnvironment, environmentColors } = useEnvironment()

  /**
   * 現在のテーマカラーを取得
   */
  const currentThemeColor = computed(() => {
    return environmentColors.value
  })

  /**
   * ダークモードかどうか
   */
  const isDark = computed(() => {
    return colorMode.value === 'dark'
  })

  /**
   * カラーモードを切り替え
   */
  const toggleColorMode = () => {
    colorMode.preference = isDark.value ? 'light' : 'dark'
  }

  /**
   * カラーモードを設定
   */
  const setColorMode = (mode: ColorMode) => {
    colorMode.preference = mode
  }

  return {
    colorMode,
    currentThemeColor,
    isDark,
    toggleColorMode,
    setColorMode
  }
}
```

---

## 確認事項

- [ ] ファイルが作成されたか
- [ ] useColorModeが正しく使用されているか
- [ ] 環境カラーと連携しているか
- [ ] useEnvironmentを正しくインポートしているか
- [ ] toggleColorModeが正常に動作するか

---

## 成果物

- `app/composables/useTheme.ts`

---

## テスト項目

| テスト内容 | 期待結果 |
|-----------|---------|
| useColorModeが正しく読み込めるか | ✓ |
| currentThemeColorが環境カラーを返すか | ✓ |
| isDarkがダークモードを正しく判定するか | ✓ |
| toggleColorModeでテーマが切り替わるか | ✓ |
| setColorModeで任意のモードを設定できるか | ✓ |

---

## 依存関係

- `useEnvironment()` から `currentEnvironment`, `environmentColors` を取得
- `useColorMode()` (Nuxt標準) を使用
- `~/types` から `ColorMode` 型をインポート

---

## 次のタスク

→ [2.2.1: connectionストア移行](2.2.1_connectionStore.md)
