# タスクリスト - SQLエディタ画面の多言語対応

## 進捗サマリー

| 状態 | 件数 |
|------|------|
| 完了 | 0 |
| 進行中 | 0 |
| 未着手 | 10 |

## タスク一覧

### T-1: ロケールファイルへの翻訳キー追加

**関連要件**: F-1

- [ ] ja.json に `sqlEditor` セクションを追加
  - [ ] `toolbar` サブセクション（ツールバー関連）
  - [ ] `layout` サブセクション（レイアウト関連）
  - [ ] `savedPanel` サブセクション（保存クエリパネル）
  - [ ] `historyPanel` サブセクション（履歴パネル）
  - [ ] `resultPanel` サブセクション（結果パネル）
  - [ ] `saveDialog` サブセクション（保存ダイアログ）
- [ ] en.json に `sqlEditor` セクションを追加（日本語版と同じ構造）
  - [ ] 全キーに対する適切な英訳を提供
- [ ] キー構造が他のセクションと一貫性があることを確認
- [ ] 動作確認：言語設定を切り替えて翻訳が正しく読み込まれることを確認

**対象ファイル**:
- `i18n/locales/ja.json`
- `i18n/locales/en.json`

**見積もり**: 2-3時間

---

### T-2: SqlEditorLayout.vue の多言語対応

**関連要件**: F-2

- [ ] `useI18n()` をインポート（必要に応じて）
- [ ] "保存クエリ" を `$t('sqlEditor.layout.savedPanelTitle')` に置き換え
- [ ] "実行履歴" を `$t('sqlEditor.layout.historyPanelTitle')` に置き換え
- [ ] 動作確認：言語切り替え時に表示が更新されることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorLayout.vue`

**見積もり**: 15分

---

### T-3: SqlEditorToolbar.vue の多言語対応

**関連要件**: F-3

- [ ] `const { t } = useI18n()` を追加
- [ ] ボタンラベルを翻訳キーに置き換え
  - [ ] "実行" → `:label="$t('sqlEditor.toolbar.execute')"`
  - [ ] "停止" → `:label="$t('sqlEditor.toolbar.stop')"`
  - [ ] "整形" → `:label="$t('sqlEditor.toolbar.format')"`
  - [ ] "保存" → `:label="$t('sqlEditor.toolbar.save')"`
- [ ] ツールチップを翻訳キーに置き換え
  - [ ] パネル表示/非表示のツールチップ
  - [ ] ダークモード切り替えのツールチップ
- [ ] 更新確認ダイアログを翻訳キーに置き換え
  - [ ] ダイアログタイトル
  - [ ] 説明文
  - [ ] ボタンラベル（キャンセル、新規保存、更新）
- [ ] トースト通知を翻訳キーに置き換え
  - [ ] 更新成功メッセージ
  - [ ] 更新失敗メッセージ
- [ ] 動作確認：各ボタン、ダイアログ、トーストが正しく表示されることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorToolbar.vue`

**見積もり**: 1時間

---

### T-4: SqlEditorResultPanel.vue の多言語対応

**関連要件**: F-4

- [ ] `const { t } = useI18n()` を追加（既にある場合はスキップ）
- [ ] パネルタイトルを翻訳キーに置き換え
- [ ] 実行時間表示を翻訳キーに置き換え
  - [ ] プレースホルダーを使用して秒数を動的に表示
- [ ] 行数表示を翻訳キーに置き換え
  - [ ] SELECT結果と Mutation 結果で異なるメッセージを使用
- [ ] エラーメッセージを翻訳キーに置き換え
  - [ ] エラー位置表示
- [ ] エクスポートボタンラベルを翻訳キーに置き換え
- [ ] "実行中..." メッセージを翻訳キーに置き換え
- [ ] "クエリを実行してください" メッセージを翻訳キーに置き換え
- [ ] 動作確認：各状態で正しいメッセージが表示されることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorResultPanel.vue`

**見積もり**: 1時間

---

### T-5: SqlEditorSaveDialog.vue の多言語対応

**関連要件**: F-7

- [ ] `const { t } = useI18n()` を追加
- [ ] ダイアログタイトルと説明を翻訳キーに置き換え
  - [ ] 新規作成時と編集時で異なるタイトル
- [ ] フォームラベルを翻訳キーに置き換え
  - [ ] クエリ名ラベル
  - [ ] 説明ラベル
  - [ ] タグラベル
  - [ ] フォルダラベル
- [ ] プレースホルダーを翻訳キーに置き換え
  - [ ] 各入力フィールドのプレースホルダー
- [ ] ヒントテキストを翻訳キーに置き換え
- [ ] バリデーションエラーメッセージを翻訳キーに置き換え
  - [ ] `validate()` 関数内のエラーメッセージを修正
- [ ] ボタンラベルを翻訳キーに置き換え
  - [ ] キャンセル、保存
- [ ] トースト通知を翻訳キーに置き換え
  - [ ] 接続なしエラー
  - [ ] SQL空エラー
  - [ ] 保存成功
  - [ ] 保存失敗
  - [ ] 更新成功
  - [ ] 更新失敗
- [ ] 動作確認：各バリデーション、トーストが正しく表示されることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorSaveDialog.vue`

**見積もり**: 1.5時間

---

### T-6: SqlEditorSavedPanel.vue の多言語対応

**関連要件**: F-5

- [ ] `const { t } = useI18n()` を追加
- [ ] 検索プレースホルダーを翻訳キーに置き換え
- [ ] ボタンラベルを翻訳キーに置き換え
  - [ ] "新規フォルダ" ボタン
- [ ] タグフィルタ関連の文言を翻訳キーに置き換え
- [ ] "読み込み中のクエリ" ラベルを翻訳キーに置き換え
- [ ] コンテキストメニュー項目を翻訳キーに置き換え
  - [ ] フォルダメニュー項目（新規フォルダ、名前変更、削除、展開、折りたたみ）
  - [ ] クエリメニュー項目（読み込み、実行、編集、移動、ルートに移動、削除）
- [ ] トースト通知を翻訳キーに置き換え（10種類以上）
  - [ ] 読み込み成功/失敗
  - [ ] 実行失敗
  - [ ] 削除成功/失敗
  - [ ] 移動成功/失敗
  - [ ] フォルダ作成成功/失敗
  - [ ] フォルダ名変更成功/失敗
  - [ ] フォルダ削除成功/失敗
  - [ ] フォルダ空でないエラー
  - [ ] フォルダ重複エラー
- [ ] ダイアログを翻訳キーに置き換え
  - [ ] 読み込み確認ダイアログ
  - [ ] クエリ削除確認ダイアログ
  - [ ] フォルダ削除確認ダイアログ
- [ ] 動作確認：全ての操作で正しいメッセージが表示されることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorSavedPanel.vue`

**見積もり**: 2-3時間（最も多いハードコード文字列を含むため）

---

### T-7: SqlEditorHistoryPanel.vue の多言語対応

**関連要件**: F-6

- [ ] `const { t, locale } = useI18n()` を追加
- [ ] 検索プレースホルダーを翻訳キーに置き換え
- [ ] フィルタラベル（"成功のみ表示"）を翻訳キーに置き換え
- [ ] "履歴がありません" メッセージを翻訳キーに置き換え
- [ ] ステータス表示を翻訳キーに置き換え
  - [ ] "成功" → `t('sqlEditor.historyPanel.status.success')`
  - [ ] "失敗" → `t('sqlEditor.historyPanel.status.failure')`
- [ ] 相対時刻表示関数を多言語対応
  - [ ] `formatRelativeTime()` 関数を修正
  - [ ] "数秒前", "○分前", "今日 HH:MM" を翻訳キーに置き換え
  - [ ] ロケールに応じた日付フォーマット（ja-JP / en-US）
- [ ] 実行時間表示を翻訳キーに置き換え
  - [ ] `formatExecutionTime()` 関数を修正（必要に応じて）
- [ ] トースト通知を翻訳キーに置き換え
  - [ ] 読み込み成功/失敗
  - [ ] 再実行開始/成功/失敗
  - [ ] 削除成功/失敗
- [ ] ダイアログを翻訳キーに置き換え
  - [ ] 読み込み確認ダイアログ
  - [ ] 削除確認ダイアログ
- [ ] 動作確認：各言語で自然な時刻表示が行われることを確認

**対象ファイル**:
- `app/components/sql-editor/SqlEditorHistoryPanel.vue`

**見積もり**: 2時間（相対時刻表示のロジック修正が必要なため）

---

### T-8: その他のSQLエディタ関連コンポーネントの多言語対応

**関連要件**: F-8

- [ ] EditorTabs.vue のハードコード文字列を調査
- [ ] ハードコード文字列がある場合は翻訳キーに置き換え
- [ ] ダイアログコンポーネントの多言語対応
  - [ ] CreateFolderDialog.vue
  - [ ] RenameFolderDialog.vue
  - [ ] MoveQueryDialog.vue
  - [ ] その他のダイアログコンポーネント
- [ ] 動作確認：全てのコンポーネントで正しく表示されることを確認

**対象ファイル**:
- `app/components/sql-editor/EditorTabs.vue`
- `app/components/sql-editor/dialogs/*.vue`

**見積もり**: 1-2時間

---

### T-9: 動作確認・テスト

**関連要件**: 全要件

- [ ] 日本語環境での動作確認
  - [ ] 全ての画面で日本語が正しく表示される
  - [ ] 既存の表示と変わらないことを確認
- [ ] 英語環境での動作確認
  - [ ] 設定画面で言語を English に切り替え
  - [ ] 全ての画面で英語が正しく表示される
  - [ ] 自然な英語表現であることを確認
- [ ] 言語切り替え時の動作確認
  - [ ] 言語切り替え後、全ての画面で表示が更新される
  - [ ] リアクティブに表示が変更されることを確認
- [ ] エッジケースの確認
  - [ ] 相対時刻表示が各言語で自然に表示される
  - [ ] 動的な値を含むメッセージが正しくフォーマットされる
  - [ ] プレースホルダーが正しく置換される
- [ ] 翻訳漏れのチェック
  - [ ] 全ての画面を操作して、ハードコード文字列が残っていないか確認
  - [ ] 開発者ツールでコンソールエラーがないことを確認

**見積もり**: 1-2時間

---

### T-10: ドキュメント更新

**関連要件**: 全要件

- [ ] 永続化ドキュメントの確認と更新（必要に応じて）
  - [ ] `docs/steering/02_functional_design.md` に多言語対応の実装状態を反映
- [ ] 作業ドキュメントの更新
  - [ ] `tasklist.md` の進捗を更新
  - [ ] `testing.md` を作成（テスト手順を記載）
- [ ] コミットメッセージの作成
  - [ ] 適切なコミットメッセージで変更をコミット

**見積もり**: 30分

---

## 完了条件

- [ ] 全タスク（T-1 〜 T-10）が完了
- [ ] 日本語環境と英語環境の両方で全ての画面が正しく表示される
- [ ] 翻訳漏れがない（全てのハードコード文字列が翻訳キーに置き換えられている）
- [ ] 言語切り替え時にリアクティブに表示が更新される
- [ ] 既存機能に影響がない（回帰バグがない）
- [ ] ドキュメントが更新されている

## タスクの依存関係

```
T-1（ロケールファイル）
  ↓
T-2, T-3, T-4, T-5, T-6, T-7, T-8（各コンポーネント）← 並行作業可能
  ↓
T-9（動作確認・テスト）
  ↓
T-10（ドキュメント更新）
```

## 推奨作業順序

1. **T-1**: ロケールファイルへの翻訳キー追加（最初に完了させる）
2. **T-2**: SqlEditorLayout.vue（最もシンプル）
3. **T-4**: SqlEditorResultPanel.vue（比較的シンプル）
4. **T-3**: SqlEditorToolbar.vue（中程度の複雑さ）
5. **T-5**: SqlEditorSaveDialog.vue（中程度の複雑さ）
6. **T-7**: SqlEditorHistoryPanel.vue（相対時刻表示のロジック修正が必要）
7. **T-6**: SqlEditorSavedPanel.vue（最も多くの文字列を含む）
8. **T-8**: その他のコンポーネント
9. **T-9**: 動作確認・テスト
10. **T-10**: ドキュメント更新

この順序により、シンプルなものから始めて段階的に複雑なものに取り組むことができます。
