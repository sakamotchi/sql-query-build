# WBS: SELECT句拡張プロジェクト

## プロジェクト概要

- **プロジェクト名**: SELECT句拡張（関数・サブクエリ対応）
- **プロジェクトコード**: select-clause-extension
- **作成日**: 2026-01-02
- **最終更新**: 2026-01-02

---

## WBS凡例

- **タスクID**: 階層構造のID（例: 1.1.1）
- **タスク名**: タスクの名称
- **説明**: タスクの詳細説明
- **成果物**: タスク完了時の成果物
- **見積もり**: 作業量の見積もり（小/中/大）
  - 小: 数時間〜半日
  - 中: 半日〜1日
  - 大: 1日以上
- **依存**: 先行タスク（このタスクを開始する前に完了が必要）
- **状態**: 未着手/進行中/完了

---

## Phase 1: 式ツリー基盤構築

### 1. 型定義とモデル拡張

#### 1.1 バックエンド型定義（Rust）

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 1.1.1 | ExpressionNode型定義 | `src-tauri/src/models/query.rs`にExpressionNode enumを追加 | ExpressionNode型 | 小 | - | 未着手 |
| 1.1.2 | SelectColumn型拡張 | SelectColumn enumを拡張（Simple/Expression/All） | SelectColumn型 | 小 | 1.1.1 | 未着手 |
| 1.1.3 | ExpressionError型定義 | `src-tauri/src/models/expression_error.rs`を新規作成 | ExpressionError型 | 小 | - | 未着手 |
| 1.1.4 | シリアライゼーションテスト | 型のシリアライズ/デシリアライズが正しく動作するか確認 | 単体テスト | 小 | 1.1.1, 1.1.2 | 未着手 |

#### 1.2 フロントエンド型定義（TypeScript）

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 1.2.1 | ExpressionNode型定義 | `app/types/query-model.ts`にExpressionNode型を追加 | ExpressionNode型 | 小 | - | 未着手 |
| 1.2.2 | SelectColumn型拡張 | SelectColumn型を拡張 | SelectColumn型 | 小 | 1.2.1 | 未着手 |
| 1.2.3 | 型整合性テスト | フロントとバックエンドの型が一致するか確認 | テストコード | 小 | 1.1.2, 1.2.2 | 未着手 |

### 2. バックエンドSQL生成ロジック

#### 2.1 ExpressionBuilder実装

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 2.1.1 | ExpressionBuilder構造体作成 | `src-tauri/src/sql/expression_builder.rs`を新規作成 | expression_builder.rs | 小 | 1.1.1 | 未着手 |
| 2.1.2 | カラム参照SQL生成 | ColumnReference → "table.column" | build()メソッド | 小 | 2.1.1 | 未着手 |
| 2.1.3 | リテラル値SQL生成 | LiteralValue → "'string'" / "123" / "TRUE" 等 | build_literal()メソッド | 小 | 2.1.1 | 未着手 |
| 2.1.4 | 関数呼び出しSQL生成 | FunctionCall → "UPPER(column)" 等 | build_function()メソッド | 中 | 2.1.1 | 未着手 |
| 2.1.5 | サブクエリSQL生成 | SubqueryExpression → "(SELECT ...)" | build()メソッド拡張 | 小 | 2.1.1 | 未着手 |
| 2.1.6 | 二項演算SQL生成 | BinaryOperation → "(a + b)" | build()メソッド拡張 | 小 | 2.1.1 | 未着手 |
| 2.1.7 | 単項演算SQL生成 | UnaryOperation → "(- a)" | build()メソッド拡張 | 小 | 2.1.1 | 未着手 |
| 2.1.8 | ネスト処理実装 | 再帰的な式の処理 | build()メソッド完成 | 中 | 2.1.2-2.1.7 | 未着手 |
| 2.1.9 | 単体テスト作成 | 各式タイプのテストケース作成 | テストコード | 中 | 2.1.8 | 未着手 |

#### 2.2 DialectMapper実装

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 2.2.1 | DialectMapper構造体作成 | `src-tauri/src/sql/dialect_mapper.rs`を新規作成 | dialect_mapper.rs | 小 | - | 未着手 |
| 2.2.2 | PostgreSQL関数マッピング | PostgreSQL用の関数名マッピングテーブル | init_postgresql()メソッド | 中 | 2.2.1 | 未着手 |
| 2.2.3 | MySQL関数マッピング | MySQL用の関数名マッピングテーブル | init_mysql()メソッド | 中 | 2.2.1 | 未着手 |
| 2.2.4 | SQLite関数マッピング | SQLite用の関数名マッピングテーブル | init_sqlite()メソッド | 中 | 2.2.1 | 未着手 |
| 2.2.5 | 関数名変換メソッド | 標準関数名 → DB方言関数名 | map_function()メソッド | 小 | 2.2.2-2.2.4 | 未着手 |
| 2.2.6 | 特殊処理実装 | CONCAT → ||（SQLite）等の特殊変換 | 特殊処理ロジック | 中 | 2.2.5 | 未着手 |
| 2.2.7 | 単体テスト作成 | 各DB方言のマッピングテスト | テストコード | 中 | 2.2.6 | 未着手 |

#### 2.3 SelectBuilder拡張

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 2.3.1 | SelectBuilder構造体拡張 | ExpressionBuilderを統合 | select_builder.rs更新 | 小 | 2.1.8 | 未着手 |
| 2.3.2 | Expression列のSQL生成 | SelectColumn::Expression → SQL | build_column()拡張 | 中 | 2.3.1 | 未着手 |
| 2.3.3 | エイリアス処理 | AS句の適切な生成 | build_column()完成 | 小 | 2.3.2 | 未着手 |
| 2.3.4 | 統合テスト作成 | SELECT句全体のテスト | テストコード | 中 | 2.3.3 | 未着手 |

#### 2.4 QueryBuilder統合

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 2.4.1 | QueryBuilder更新 | SelectBuilderの呼び出しを更新 | query_builder.rs更新 | 小 | 2.3.3 | 未着手 |
| 2.4.2 | generate_sqlコマンド更新 | Tauriコマンドを更新 | commands/query.rs更新 | 小 | 2.4.1 | 未着手 |
| 2.4.3 | E2Eテスト作成 | フロントからバックエンドまでの統合テスト | テストコード | 大 | 2.4.2 | 未着手 |

### 3. フロントエンドUI実装（シンプル版）

#### 3.1 基本UIコンポーネント

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 3.1.1 | ExpressionEditor.vue作成 | メインの式エディタコンポーネント | ExpressionEditor.vue | 中 | 1.2.2 | 未着手 |
| 3.1.2 | テキスト入力UI実装 | Phase 1では文字列での式入力のみ | Textarea実装 | 小 | 3.1.1 | 未着手 |
| 3.1.3 | ExpressionPreview.vue作成 | SQL式のプレビュー表示 | ExpressionPreview.vue | 小 | - | 未着手 |
| 3.1.4 | LiteralValueInput.vue作成 | リテラル値入力UI（Phase 2以降で使用） | LiteralValueInput.vue | 小 | - | 未着手 |

#### 3.2 バリデーション

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 3.2.1 | バリデーション関数作成 | `app/utils/expression-validator.ts`を作成 | validateExpression()関数 | 中 | 1.2.1 | 未着手 |
| 3.2.2 | 深さチェック実装 | 式ツリーの深さを最大10レベルに制限 | validateDepth()関数 | 小 | 3.2.1 | 未着手 |
| 3.2.3 | 引数数チェック実装 | 関数の引数数をチェック | validateArguments()関数 | 小 | 3.2.1 | 未着手 |
| 3.2.4 | エラーメッセージ実装 | わかりやすい日本語エラーメッセージ | エラーメッセージ定義 | 小 | 3.2.1-3.2.3 | 未着手 |
| 3.2.5 | 単体テスト作成 | バリデーションのテストケース | テストコード | 中 | 3.2.4 | 未着手 |

#### 3.3 Storeロジック

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 3.3.1 | query-builder store拡張 | ExpressionNode管理機能を追加 | store更新 | 中 | 1.2.2 | 未着手 |
| 3.3.2 | プレビューSQL生成 | フロント側で簡易的なSQL生成（即座のプレビュー用） | generatePreviewSql()関数 | 中 | 3.3.1 | 未着手 |
| 3.3.3 | 式の追加/編集/削除 | CRUDロジック実装 | storeアクション | 中 | 3.3.1 | 未着手 |

#### 3.4 UI統合

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 3.4.1 | SELECT句UIに統合 | QueryBuilder.vueにExpressionEditorを統合 | QueryBuilder.vue更新 | 中 | 3.1.2, 3.3.3 | 未着手 |
| 3.4.2 | レスポンシブ対応 | モバイル・デスクトップ対応 | CSS調整 | 小 | 3.4.1 | 未着手 |

### 4. Phase 1完成とテスト

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 4.1 | 機能テスト | すべての基本機能が動作することを確認 | テスト結果 | 大 | 3.4.2, 2.4.3 | 未着手 |
| 4.2 | パフォーマンステスト | 深いネスト式でもパフォーマンスが問題ないか確認 | パフォーマンス計測 | 中 | 4.1 | 未着手 |
| 4.3 | リグレッションテスト | 既存機能が壊れていないか確認 | テスト結果 | 大 | 4.1 | 未着手 |
| 4.4 | ドキュメント更新 | 永続化ドキュメント更新（機能設計書等） | ドキュメント | 中 | 4.3 | 未着手 |
| 4.5 | Phase 1完了レビュー | レビューと受け入れ確認 | レビューレポート | 中 | 4.4 | 未着手 |

---

## Phase 2: 関数ビルダーUI

### 5. 関数マスターデータ

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 5.1 | 関数定義型作成 | FunctionDefinition型を定義 | 型定義 | 小 | Phase 1完了 | 未着手 |
| 5.2 | 文字列関数定義 | UPPER, LOWER, CONCAT, SUBSTRING等の定義 | 関数マスター | 中 | 5.1 | 未着手 |
| 5.3 | 日付関数定義 | NOW, CURRENT_DATE等の定義 | 関数マスター | 中 | 5.1 | 未着手 |
| 5.4 | 数値関数定義 | ROUND, CEIL, FLOOR, ABS等の定義 | 関数マスター | 中 | 5.1 | 未着手 |
| 5.5 | 条件関数定義 | COALESCE, NULLIF等の定義 | 関数マスター | 中 | 5.1 | 未着手 |
| 5.6 | 集計関数定義 | COUNT, SUM, AVG, MIN, MAX等の定義 | 関数マスター | 中 | 5.1 | 未着手 |
| 5.7 | 関数マスターテスト | 定義データのバリデーション | テストコード | 小 | 5.2-5.6 | 未着手 |

### 6. FunctionBuilder UI実装

#### 6.1 カテゴリ選択UI

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 6.1.1 | FunctionBuilder.vue作成 | 関数ビルダーメインコンポーネント | FunctionBuilder.vue | 中 | 5.7 | 未着手 |
| 6.1.2 | カテゴリ選択UI実装 | 文字列/日付/数値/条件/集計から選択 | USelectMenu実装 | 小 | 6.1.1 | 未着手 |
| 6.1.3 | カテゴリアイコン実装 | 各カテゴリのアイコン表示 | アイコン設定 | 小 | 6.1.2 | 未着手 |

#### 6.2 関数選択UI

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 6.2.1 | 関数リスト表示 | カテゴリ別に関数をリスト表示 | USelectMenu実装 | 中 | 6.1.3 | 未着手 |
| 6.2.2 | 関数検索機能 | 関数名で検索できる機能 | 検索機能 | 小 | 6.2.1 | 未着手 |
| 6.2.3 | 関数説明表示 | 選択した関数の説明・例を表示 | UAlert実装 | 小 | 6.2.1 | 未着手 |

#### 6.3 引数設定UI

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 6.3.1 | 動的引数フォーム生成 | 関数の引数定義に基づいてフォーム生成 | 動的フォーム | 中 | 6.2.1 | 未着手 |
| 6.3.2 | 引数タイプ選択 | カラム/リテラル/関数/サブクエリから選択 | セレクター実装 | 中 | 6.3.1 | 未着手 |
| 6.3.3 | ネストした関数入力 | 引数として関数を指定可能 | 再帰的コンポーネント | 大 | 6.3.2 | 未着手 |
| 6.3.4 | 引数バリデーション | データ型・必須チェック | バリデーション実装 | 中 | 6.3.3 | 未着手 |

#### 6.4 プレビュー機能

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 6.4.1 | リアルタイムプレビュー | 関数設定中にSQL式をプレビュー | プレビュー表示 | 中 | 6.3.4 | 未着手 |
| 6.4.2 | シンタックスハイライト | SQL式をハイライト表示 | ハイライト実装 | 小 | 6.4.1 | 未着手 |
| 6.4.3 | デバウンス処理 | プレビュー更新を300ms遅延 | デバウンス実装 | 小 | 6.4.1 | 未着手 |

### 7. ExpressionEditor統合

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 7.1 | 式タイプセレクター実装 | テキスト/カラム/関数/サブクエリから選択 | ExpressionTypeSelector.vue | 中 | 6.4.3 | 未着手 |
| 7.2 | FunctionBuilder統合 | ExpressionEditorからFunctionBuilderを呼び出し | 統合実装 | 中 | 7.1 | 未着手 |
| 7.3 | ExpressionNode構築 | FunctionBuilderの結果をExpressionNodeに変換 | 変換ロジック | 中 | 7.2 | 未着手 |

### 8. Phase 2完成とテスト

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 8.1 | 機能テスト | 関数ビルダーの全機能テスト | テスト結果 | 大 | 7.3 | 未着手 |
| 8.2 | ユーザビリティテスト | UIの使いやすさ確認 | フィードバック | 中 | 8.1 | 未着手 |
| 8.3 | リグレッションテスト | Phase 1機能が壊れていないか確認 | テスト結果 | 大 | 8.1 | 未着手 |
| 8.4 | ドキュメント更新 | 永続化ドキュメント更新 | ドキュメント | 中 | 8.3 | 未着手 |
| 8.5 | Phase 2完了レビュー | レビューと受け入れ確認 | レビューレポート | 中 | 8.4 | 未着手 |

---

## Phase 3: サブクエリビルダーUI

### 9. サブクエリビルダー基盤

#### 9.1 サブクエリコンポーネント

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 9.1.1 | SubqueryBuilder.vue作成 | サブクエリビルダーメインコンポーネント | SubqueryBuilder.vue | 大 | Phase 2完了 | 未着手 |
| 9.1.2 | ミニクエリビルダーUI | 簡易版QueryBuilderを実装 | UI実装 | 大 | 9.1.1 | 未着手 |
| 9.1.3 | FROM句テーブル選択 | サブクエリのFROM句設定 | テーブル選択UI | 中 | 9.1.2 | 未着手 |
| 9.1.4 | SELECT句カラム選択 | サブクエリのSELECT句設定（単一カラムのみ） | カラム選択UI | 中 | 9.1.2 | 未着手 |
| 9.1.5 | WHERE句条件設定 | サブクエリのWHERE句設定 | 条件設定UI | 大 | 9.1.2 | 未着手 |

#### 9.2 相関サブクエリ対応

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 9.2.1 | 外部クエリカラム参照 | 外部クエリのカラムを参照可能に | カラム参照実装 | 大 | 9.1.5 | 未着手 |
| 9.2.2 | 相関検証ロジック | 相関サブクエリのバリデーション | バリデーション実装 | 中 | 9.2.1 | 未着手 |
| 9.2.3 | 循環参照チェック | サブクエリの無限ループ検出 | チェック機能 | 中 | 9.2.2 | 未着手 |

#### 9.3 集計関数対応

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 9.3.1 | 集計関数選択UI | COUNT, SUM, AVG, MIN, MAX選択 | UI実装 | 中 | 9.1.4 | 未着手 |
| 9.3.2 | 集計式生成 | 集計関数を含むサブクエリSQL生成 | SQL生成ロジック | 中 | 9.3.1 | 未着手 |

### 10. バリデーション強化

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 10.1 | スカラー値チェック | サブクエリが単一値を返すかチェック | バリデーション実装 | 中 | 9.1.4 | 未着手 |
| 10.2 | サブクエリ実行検証 | サブクエリが実行可能かバックエンドで検証 | バリデーションAPI | 大 | 10.1 | 未着手 |
| 10.3 | エラーメッセージ改善 | サブクエリ特有のエラーメッセージ | エラーメッセージ定義 | 小 | 10.2 | 未着手 |

### 11. ExpressionEditor統合

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 11.1 | SubqueryBuilder統合 | ExpressionEditorからSubqueryBuilderを呼び出し | 統合実装 | 中 | 9.3.2, 10.3 | 未着手 |
| 11.2 | ExpressionNode構築 | SubqueryBuilderの結果をExpressionNodeに変換 | 変換ロジック | 中 | 11.1 | 未着手 |
| 11.3 | プレビュー統合 | サブクエリを含む式のプレビュー | プレビュー実装 | 中 | 11.2 | 未着手 |

### 12. Phase 3完成とテスト

| タスクID | タスク名 | 説明 | 成果物 | 見積もり | 依存 | 状態 |
|---------|---------|------|--------|---------|------|------|
| 12.1 | 機能テスト | サブクエリビルダーの全機能テスト | テスト結果 | 大 | 11.3 | 未着手 |
| 12.2 | 相関サブクエリテスト | 相関サブクエリの動作確認 | テスト結果 | 大 | 12.1 | 未着手 |
| 12.3 | パフォーマンステスト | 複雑なサブクエリでのパフォーマンス確認 | パフォーマンス計測 | 中 | 12.1 | 未着手 |
| 12.4 | リグレッションテスト | 全機能が正常に動作するか確認 | テスト結果 | 大 | 12.1 | 未着手 |
| 12.5 | ドキュメント更新 | 永続化ドキュメント更新 | ドキュメント | 中 | 12.4 | 未着手 |
| 12.6 | Phase 3完了レビュー | レビューと受け入れ確認 | レビューレポート | 中 | 12.5 | 未着手 |
| 12.7 | プロジェクト完了 | 全フェーズ完了、リリース準備 | リリース判定 | 中 | 12.6 | 未着手 |

---

## タスク依存関係図

```
Phase 1: 式ツリー基盤構築
├─ 1. 型定義とモデル拡張
│  ├─ 1.1 バックエンド型定義（Rust）
│  │  └─ 1.1.1 → 1.1.2 → 1.1.4
│  └─ 1.2 フロントエンド型定義（TypeScript）
│     └─ 1.2.1 → 1.2.2 → 1.2.3
│
├─ 2. バックエンドSQL生成ロジック
│  ├─ 2.1 ExpressionBuilder実装
│  │  └─ 2.1.1 → 2.1.2-2.1.7 → 2.1.8 → 2.1.9
│  ├─ 2.2 DialectMapper実装
│  │  └─ 2.2.1 → 2.2.2-2.2.4 → 2.2.5 → 2.2.6 → 2.2.7
│  ├─ 2.3 SelectBuilder拡張
│  │  └─ 2.3.1 → 2.3.2 → 2.3.3 → 2.3.4
│  └─ 2.4 QueryBuilder統合
│     └─ 2.4.1 → 2.4.2 → 2.4.3
│
├─ 3. フロントエンドUI実装（シンプル版）
│  ├─ 3.1 基本UIコンポーネント
│  │  └─ 3.1.1 → 3.1.2
│  ├─ 3.2 バリデーション
│  │  └─ 3.2.1 → 3.2.2-3.2.4 → 3.2.5
│  ├─ 3.3 Storeロジック
│  │  └─ 3.3.1 → 3.3.2, 3.3.3
│  └─ 3.4 UI統合
│     └─ 3.4.1 → 3.4.2
│
└─ 4. Phase 1完成とテスト
   └─ 4.1 → 4.2, 4.3 → 4.4 → 4.5

Phase 2: 関数ビルダーUI
├─ 5. 関数マスターデータ
│  └─ 5.1 → 5.2-5.6 → 5.7
│
├─ 6. FunctionBuilder UI実装
│  ├─ 6.1 カテゴリ選択UI
│  │  └─ 6.1.1 → 6.1.2 → 6.1.3
│  ├─ 6.2 関数選択UI
│  │  └─ 6.2.1 → 6.2.2, 6.2.3
│  ├─ 6.3 引数設定UI
│  │  └─ 6.3.1 → 6.3.2 → 6.3.3 → 6.3.4
│  └─ 6.4 プレビュー機能
│     └─ 6.4.1 → 6.4.2, 6.4.3
│
├─ 7. ExpressionEditor統合
│  └─ 7.1 → 7.2 → 7.3
│
└─ 8. Phase 2完成とテスト
   └─ 8.1 → 8.2, 8.3 → 8.4 → 8.5

Phase 3: サブクエリビルダーUI
├─ 9. サブクエリビルダー基盤
│  ├─ 9.1 サブクエリコンポーネント
│  │  └─ 9.1.1 → 9.1.2 → 9.1.3, 9.1.4, 9.1.5
│  ├─ 9.2 相関サブクエリ対応
│  │  └─ 9.2.1 → 9.2.2 → 9.2.3
│  └─ 9.3 集計関数対応
│     └─ 9.3.1 → 9.3.2
│
├─ 10. バリデーション強化
│  └─ 10.1 → 10.2 → 10.3
│
├─ 11. ExpressionEditor統合
│  └─ 11.1 → 11.2 → 11.3
│
└─ 12. Phase 3完成とテスト
   └─ 12.1 → 12.2, 12.3, 12.4 → 12.5 → 12.6 → 12.7
```

---

## 進捗トラッキング

### Phase 1進捗

| 大分類 | 完了タスク数 | 総タスク数 | 進捗率 |
|--------|------------|-----------|--------|
| 1. 型定義とモデル拡張 | 0 | 7 | 0% |
| 2. バックエンドSQL生成ロジック | 0 | 24 | 0% |
| 3. フロントエンドUI実装 | 0 | 14 | 0% |
| 4. Phase 1完成とテスト | 0 | 5 | 0% |
| **Phase 1合計** | **0** | **50** | **0%** |

### Phase 2進捗

| 大分類 | 完了タスク数 | 総タスク数 | 進捗率 |
|--------|------------|-----------|--------|
| 5. 関数マスターデータ | 0 | 7 | 0% |
| 6. FunctionBuilder UI実装 | 0 | 13 | 0% |
| 7. ExpressionEditor統合 | 0 | 3 | 0% |
| 8. Phase 2完成とテスト | 0 | 5 | 0% |
| **Phase 2合計** | **0** | **28** | **0%** |

### Phase 3進捗

| 大分類 | 完了タスク数 | 総タスク数 | 進捗率 |
|--------|------------|-----------|--------|
| 9. サブクエリビルダー基盤 | 0 | 10 | 0% |
| 10. バリデーション強化 | 0 | 3 | 0% |
| 11. ExpressionEditor統合 | 0 | 3 | 0% |
| 12. Phase 3完成とテスト | 0 | 7 | 0% |
| **Phase 3合計** | **0** | **23** | **0%** |

### プロジェクト全体

| 項目 | 値 |
|------|-----|
| 総タスク数 | 101 |
| 完了タスク数 | 0 |
| 進行中タスク数 | 0 |
| 未着手タスク数 | 101 |
| 全体進捗率 | 0% |

---

## クリティカルパス

以下のタスクがプロジェクトのクリティカルパスとなる：

1. **Phase 1**: 1.1.1 → 1.1.2 → 1.2.2 → 2.1.1 → 2.1.8 → 2.2.6 → 2.3.3 → 2.4.2 → 3.1.2 → 3.3.3 → 3.4.1 → 4.1 → 4.5
2. **Phase 2**: 5.1 → 5.7 → 6.1.1 → 6.3.3 → 6.4.1 → 7.3 → 8.1 → 8.5
3. **Phase 3**: 9.1.1 → 9.1.2 → 9.2.1 → 10.2 → 11.3 → 12.1 → 12.7

このパス上のタスクが遅延すると、プロジェクト全体の完了が遅れるため、優先的に取り組む必要がある。

---

## リスク管理

| リスクID | リスク | 影響タスク | 緩和策 |
|---------|-------|----------|--------|
| R-1 | ExpressionNode型の再帰的構造が複雑で実装が難航 | 1.1.1, 2.1.8 | 既存のWhereClauseの実装を参考にする、段階的に機能追加 |
| R-2 | データベース方言の違いが想定以上に大きい | 2.2.2-2.2.4 | 主要関数のみサポート、段階的に拡張 |
| R-3 | FunctionBuilderのネスト対応が技術的に困難 | 6.3.3 | 最初は深さ3まで、徐々に拡張 |
| R-4 | サブクエリのバリデーションが複雑 | 10.2 | Phase 3で段階的に実装、初期は簡易チェックのみ |
| R-5 | パフォーマンス劣化 | 4.2, 12.3 | 各フェーズでパフォーマンステスト実施、必要に応じて最適化 |

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 変更者 |
|------|----------|---------|--------|
| 2026-01-02 | 1.0 | 初版作成 | Claude |

---

## 関連ドキュメント

- [プロジェクト計画書](project-plan.md)
- [要件定義書](requirements.md)
- [技術設計書](design.md)
- [実装計画書](implementation-plan.md)
