# プロダクト要求定義書（PRD）

**バージョン**: 1.0
**作成日**: 2025年12月29日
**最終更新**: 2025年12月29日

---

## 1. プロダクト概要

### 1.1 プロダクト名
SQL Query Builder

### 1.2 目的
GUIベースでSQLクエリを構築できる直感的なデスクトップアプリケーション。技術者が複数のデータベース環境（開発・テスト・ステージング・本番）を安全に操作できることを目的とする。

### 1.3 ビジョン
「SQLの知識レベルに関係なく、誰でも安全かつ効率的にデータベースを操作できるツール」

### 1.4 主要な価値提案
- **視覚的なクエリ構築**: ドラッグ&ドロップによる直感的な操作
- **環境安全性**: 環境別のウィンドウ分離と色分け表示による誤操作防止
- **リアルタイムプレビュー**: SQL構文をリアルタイムで確認可能
- **マルチDB対応**: PostgreSQL、MySQL、SQLiteの主要DBをサポート

---

## 2. ターゲットユーザー

### 2.1 プライマリユーザー
| ユーザータイプ | 説明 | 主な利用シーン |
|--------------|------|--------------|
| データベースエンジニア | DBの設計・運用を担当 | 日常的なクエリ実行、データ確認 |
| バックエンド開発者 | アプリケーション開発担当 | 開発中のデータ確認、デバッグ |
| データアナリスト | データ分析を担当 | 複雑な集計クエリの構築 |

### 2.2 セカンダリユーザー
| ユーザータイプ | 説明 | 主な利用シーン |
|--------------|------|--------------|
| SQLの知識が浅い初心者エンジニア | SQLの基礎を学習中 | 学習、簡単なクエリ実行 |
| プロダクトマネージャー | データ駆動の意思決定担当 | 簡単なデータ抽出 |

### 2.3 ペルソナ例
**ペルソナ1: 田中太郎（28歳・バックエンドエンジニア）**
- 経験3年、SQLは日常的に使用
- 複数の環境（開発・ステージング・本番）を行き来して作業
- **ペインポイント**: 環境を間違えてクエリを実行してしまったことがある
- **期待**: 環境が明確に識別でき、誤操作を防止できるツール

**ペルソナ2: 鈴木花子（25歳・ジュニアエンジニア）**
- 経験1年、SQLは基本的なSELECT文のみ
- JOINやGROUP BYの構文に不安がある
- **ペインポイント**: 複雑なクエリの構文を覚えるのが大変
- **期待**: GUIで視覚的にクエリを構築できるツール

---

## 3. 主要機能

### 3.1 機能一覧

#### Phase 1（完了済み）: 基盤機能
| 機能ID | 機能名 | 説明 | 状態 |
|--------|--------|------|------|
| F001 | 接続管理 | データベース接続情報の登録・編集・削除 | ✅完了 |
| F002 | 環境分類 | 開発/テスト/ステージング/本番の環境タイプ設定 | ✅完了 |
| F003 | 環境色設定 | 環境ごとのテーマカラー設定 | ✅完了 |
| F004 | マルチウィンドウ | 複数の接続を同時に別ウィンドウで起動 | ✅完了 |
| F005 | セキュリティプロバイダー | Simple/MasterPasswordの2種類（Keychainはバックエンド実装済み、フロントエンド未実装） | ⚠️一部完了 |
| F006 | GUIクエリビルダー基盤 | テーブル選択、カラム選択、条件設定UI | ✅完了 |
| F007 | SQL生成エンジン | QueryModelからSQLを生成（DB方言対応） | ✅完了 |

#### Phase 2（次期開発）: クエリ実行・結果表示
| 機能ID | 機能名 | 説明 | 状態 |
|--------|--------|------|------|
| F101 | クエリ実行 | 構築したSQLクエリの実行 | 📝計画中 |
| F102 | 結果表示 | クエリ実行結果の表形式表示 | 📝計画中 |
| F103 | ページネーション | 大量データのページ分割表示 | 📝計画中 |
| F104 | エラーハンドリング | エラーメッセージの適切な表示 | 📝計画中 |

#### Phase 3（将来）: 安全機能
| 機能ID | 機能名 | 説明 | 状態 |
|--------|--------|------|------|
| F201 | クエリ種別検出 | UPDATE/DELETE/DROP/TRUNCATEの検出 | 📝計画中 |
| F202 | 確認ダイアログ | 危険なクエリ実行時の2段階確認 | 📝計画中 |
| F203 | 遅延実行ボタン | 本番環境での3秒待機 | 📝計画中 |

#### Phase 4（将来）: クエリ保存・履歴
| 機能ID | 機能名 | 説明 | 状態 |
|--------|--------|------|------|
| F301 | クエリ保存 | 作成したクエリの保存・読み込み | 📝計画中 |
| F302 | クエリ履歴 | 実行済みクエリの履歴管理 | 📝計画中 |
| F303 | 履歴検索 | 名前/タグでの検索 | 📝計画中 |

#### Phase 5（将来）: エクスポート機能
| 機能ID | 機能名 | 説明 | 状態 |
|--------|--------|------|------|
| F401 | CSVエクスポート | 結果をCSV形式で出力 | 📝計画中 |
| F402 | Excelエクスポート | 結果をXLSX形式で出力 | 📝計画中 |
| F403 | JSONエクスポート | 結果をJSON形式で出力 | 📝計画中 |

### 3.2 機能優先度マトリクス

```
          高インパクト
              ↑
    ┌─────────┼─────────┐
    │ Phase 2 │ Phase 3 │
    │ クエリ   │ 安全機能│
    │ 実行    │         │
低努力 ←────────┼────────→ 高努力
    │ Phase 4 │ Phase 5 │
    │ 保存    │ エクス  │
    │ 履歴    │ ポート  │
    └─────────┼─────────┘
              ↓
          低インパクト
```

---

## 4. 非機能要件

### 4.1 性能要件
| 要件ID | 要件 | 目標値 |
|--------|------|--------|
| NFR001 | アプリケーション起動時間 | 3秒以内 |
| NFR002 | クエリ実行レスポンス | DB応答時間 + 1秒以内 |
| NFR003 | GUIでの操作反映 | 0.5秒以内 |
| NFR004 | 結果セット表示 | 10万件まで対応 |
| NFR005 | メモリ使用量 | 500MB以下（通常時） |

### 4.2 ユーザビリティ要件
| 要件ID | 要件 | 説明 |
|--------|------|------|
| NFR101 | 直感的操作 | SQLの知識が浅いユーザーでも基本的なクエリを構築可能 |
| NFR102 | 環境識別 | 環境の誤認を防ぐ明確な視覚的識別 |
| NFR103 | キーボードショートカット | 主要操作のショートカット対応 |
| NFR104 | レスポンシブUI | 様々なウィンドウサイズに対応 |

### 4.3 互換性要件
| 要件ID | 要件 | 対応バージョン |
|--------|------|--------------|
| NFR201 | Windows | Windows 10以降 |
| NFR202 | macOS | macOS 11 (Big Sur)以降 |
| NFR203 | Linux | Ubuntu 20.04以降 |
| NFR204 | PostgreSQL | 12.x以降 |
| NFR205 | MySQL | 8.0以降 |
| NFR206 | SQLite | 3.x |

### 4.4 セキュリティ要件
| 要件ID | 要件 | 説明 |
|--------|------|------|
| NFR301 | 接続情報の暗号化 | AES-256-GCMによる暗号化保存 |
| NFR302 | パスワード保護 | 平文保存の禁止 |
| NFR303 | セキュリティプロバイダー選択 | Simple/MasterPasswordから選択可能（Keychainは将来対応予定） |
| NFR304 | 操作ログ | 全てのクエリ実行ログの記録（将来実装） |

### 4.5 可用性要件
| 要件ID | 要件 | 目標値 |
|--------|------|--------|
| NFR401 | オフライン動作 | インターネット接続不要で動作 |
| NFR402 | データ永続化 | アプリ終了後も設定・接続情報を保持 |
| NFR403 | クラッシュリカバリー | 異常終了後のデータ損失防止 |

---

## 5. 制約条件

### 5.1 技術的制約
- Tauriフレームワークの制限に従う
- クロスプラットフォーム対応のため、OS固有機能の使用は最小限にする
- データベースへの直接接続が必要（プロキシサーバーは対象外）

### 5.2 ビジネス制約
- オープンソースプロジェクトとして開発
- 個人開発のため、開発リソースは限定的

### 5.3 法的制約
- 使用するライブラリのライセンス遵守
- ユーザーのデータベース認証情報は端末内のみに保存

---

## 6. 成功指標（KPI）

### 6.1 プロダクト品質指標
| 指標 | 目標値 | 測定方法 |
|------|--------|---------|
| クラッシュ率 | < 0.1% | アプリ起動回数に対するクラッシュ数 |
| 起動時間 | < 3秒 | アプリ起動からUI表示まで |
| メモリリーク | 0 | 長時間使用後のメモリ増加量 |

### 6.2 ユーザー体験指標
| 指標 | 目標値 | 測定方法 |
|------|--------|---------|
| タスク完了率 | > 90% | 基本的なクエリ構築の成功率 |
| 学習コスト | < 30分 | 初回使用からクエリ実行まで |
| 環境誤認率 | 0% | 誤った環境での実行 |

---

## 7. 今後のロードマップ

### v0.2.0（Phase 2完了時）
- クエリ実行・結果表示機能
- ページネーション対応

### v0.3.0（Phase 3完了時）
- 本番環境安全機能
- 確認ダイアログ実装

### v0.4.0（Phase 4完了時）
- クエリ保存・履歴機能
- 検索・フィルタリング

### v0.5.0（Phase 5完了時）
- エクスポート機能（CSV/Excel/JSON）

### v1.0.0（Phase 6-7完了時）
- JOIN設定UIの強化
- 監査ログ
- パフォーマンス最適化
- アクセシビリティ対応

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 作成者 |
|------|----------|---------|--------|
| 2025-12-29 | 1.0 | 初版作成 | - |
