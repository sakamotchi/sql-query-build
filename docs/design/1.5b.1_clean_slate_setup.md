# 1.5b.1 クリーンスレート準備 - 詳細設計書

**作成日**: 2025-12-12
**バージョン**: 1.0
**ステータス**: 設計中
**フェーズ**: 1.5b Phase 1
**担当**: Dev
**工数**: 約20時間（2-3日）

---

## 目次

1. [概要](#1-概要)
2. [目的とゴール](#2-目的とゴール)
3. [タスク詳細設計](#3-タスク詳細設計)
4. [技術仕様](#4-技術仕様)
5. [依存関係とリスク](#5-依存関係とリスク)
6. [検証・テスト計画](#6-検証テスト計画)
7. [成果物チェックリスト](#7-成果物チェックリスト)

---

## 1. 概要

### 1.1 Phase 1の位置づけ

Phase 1は、Nuxt 4 + Nuxt UI v4へのフレッシュスタート移行の最初のフェーズで、既存のVue 3 + Vite + Vuetifyフロントエンドを完全に削除し、クリーンな状態からNuxtの開発環境を構築します。

### 1.2 期間

- **総工数**: 約20時間
- **期間**: 2-3日
- **並行作業**: 可能（環境設定とドキュメント作成など）

### 1.3 前提条件

- ✅ フェーズ1.5a（セキュリティ情報格納方式変更）が完了していること
- ✅ 既存のVue/Vuetifyコードをバックアップ可能であること
- ✅ Rustバックエンド（src-tauri/）が正常動作していること
- ✅ Node.js v20以上がインストールされていること
- ✅ Rust/Tauriの開発環境が整っていること

---

## 2. 目的とゴール

### 2.1 主要目的

1. **既存フロントエンドの安全な削除**
   - バックアップを作成してから既存コードを削除
   - Vuetify関連の依存関係を完全にクリーンアップ

2. **Nuxt 4開発環境の構築**
   - Nuxt 4の最新版をインストール
   - Nuxt UI v4とTailwind CSS v4を導入
   - Tauri統合を維持

3. **環境別テーマシステムの基盤構築**
   - 4環境（開発/テスト/ステージング/本番）のカラーパレット定義
   - Tailwind CSSでのユーティリティクラス作成

4. **動作確認**
   - Nuxt開発サーバーとTauriアプリの起動確認
   - 環境別テーマの表示確認

### 2.2 成功基準

| 項目 | 基準 |
|------|------|
| **環境構築** | Nuxt開発サーバーが起動すること |
| **Tauri統合** | Tauriアプリが起動し、Nuxt画面が表示されること |
| **テーマ確認** | 4環境のカラーが正しく表示されること |
| **ダークモード** | ライト/ダークモードが切り替わること |
| **ビルド** | `npm run build`が成功すること |
| **型チェック** | TypeScriptエラーがないこと |

---

## 3. タスク詳細設計

### 3.1 タスク1.5b.1.1: 既存フロントエンドのバックアップ

#### 3.1.1 目的

既存のVue/Vuetifyコードを安全に保存し、必要に応じて参照・復元できるようにする。

#### 3.1.2 実装手順

```bash
# 現在のブランチを確認
git branch

# バックアップブランチを作成
git checkout -b backup/vue-vuetify-implementation

# 現在の状態をコミット（未コミットの変更がある場合）
git add .
git commit -m "[backup] 既存Vue/Vuetify実装のバックアップ"

# リモートにプッシュ
git push -u origin backup/vue-vuetify-implementation

# 元のブランチに戻る
git checkout feature/nuxt-fresh-start-20251212
```

#### 3.1.3 確認事項

- [ ] バックアップブランチが作成されたか
- [ ] リモートリポジトリにプッシュされたか
- [ ] バックアップブランチで既存コードが閲覧可能か

#### 3.1.4 成果物

- ✅ `backup/vue-vuetify-implementation` ブランチ
- ✅ リモートリポジトリへのバックアップ

---

### 3.2 タスク1.5b.1.2: 移行ブランチ作成

#### 3.2.1 目的

Nuxt移行専用のブランチを作成し、作業を隔離する。

#### 3.2.2 実装手順

```bash
# 既に作成済みのブランチを使用
git checkout feature/nuxt-fresh-start-20251212

# または、新規作成する場合
# git checkout main
# git pull origin main
# git checkout -b feature/nuxt-fresh-start-20251212
# git push -u origin feature/nuxt-fresh-start-20251212
```

#### 3.2.3 確認事項

- [ ] 移行ブランチが作成されたか
- [ ] ブランチ名が命名規則に従っているか（`feature/`プレフィックス）

#### 3.2.4 成果物

- ✅ `feature/nuxt-fresh-start-20251212` ブランチ

---

### 3.3 タスク1.5b.1.3: 既存src/削除と依存関係クリーンアップ

#### 3.3.1 目的

既存のフロントエンドコードとVuetify関連の依存関係を完全に削除し、クリーンな状態にする。

#### 3.3.2 削除対象

##### ディレクトリ

- `src/` - 既存のVueアプリケーション全体
  - `src/components/` (42ファイル)
  - `src/stores/` (5ファイル)
  - `src/router/`
  - `src/views/`
  - `src/plugins/`
  - `src/types/`
  - `src/assets/`

##### ファイル

- `vite.config.ts` - Vite設定（Nuxt設定で置き換え）
- `index.html` - エントリーポイント（Nuxtが自動生成）

##### 依存関係（package.json）

```json
{
  "vuetify": "^3.10.3",
  "@mdi/font": "^7.4.47",
  "sass-embedded": "^1.93.3",
  "vue-router": "^4.4.5"
}
```

#### 3.3.3 実装手順

```bash
# 既存フロントエンドディレクトリを削除
rm -rf src/

# Vite設定を削除
rm vite.config.ts

# index.htmlを削除（Nuxtが自動生成）
rm index.html

# Vuetify関連の依存関係をアンインストール
npm uninstall vuetify @mdi/font sass-embedded vue-router

# node_modulesとロックファイルをクリーン
rm -rf node_modules package-lock.json

# 依存関係を再インストール
npm install
```

#### 3.3.4 確認事項

- [ ] `src/`ディレクトリが削除されたか
- [ ] `vite.config.ts`が削除されたか
- [ ] `package.json`にVuetify関連の依存がないか
- [ ] `npm install`が成功したか

#### 3.3.5 成果物

- ✅ クリーンな状態のプロジェクト
- ✅ 更新された`package.json`

---

### 3.4 タスク1.5b.1.4: Nuxt 3インストール

#### 3.4.1 目的

Nuxt 4の最新版をインストールし、基本的な設定を行う。

**注意**: 移行計画書ではNuxt 4と記載していますが、現時点（2025-12-12）でNuxt 4は正式リリースされていない可能性があります。最新の安定版Nuxt 3（^3.15.0）を使用し、将来的にNuxt 4へのアップグレードパスを確保します。

#### 3.4.2 インストールする依存関係

```json
{
  "dependencies": {
    "nuxt": "^3.15.0",
    "vue": "^3.5.13",
    "@tauri-apps/api": "^2.2.0"
  },
  "devDependencies": {
    "@nuxt/devtools": "^1.6.1",
    "typescript": "~5.7.2"
  }
}
```

#### 3.4.3 実装手順

```bash
# Nuxt 3をインストール
npm install nuxt@^3.15.0

# Vue 3（Nuxtが依存）
npm install vue@^3.5.13

# Tauri API最新版
npm install @tauri-apps/api@^2.2.0

# 開発用ツール
npm install -D @nuxt/devtools@^1.6.1 typescript@~5.7.2
```

#### 3.4.4 基本的なNuxt設定ファイル作成

**`nuxt.config.ts`**:

```typescript
// https://nuxt.com/docs/api/configuration/nuxt-config
export default defineNuxtConfig({
  // 将来的なNuxt 4への移行準備
  future: {
    compatibilityVersion: 4
  },

  // SSR無効（Tauri制約）
  ssr: false,

  // Appディレクトリ（Nuxt 4準拠）
  srcDir: 'app/',

  // 開発サーバー設定（Tauri用）
  devServer: {
    host: '0.0.0.0',
    port: 1420
  },

  // Vite設定（Tauri統合）
  vite: {
    clearScreen: false,
    envPrefix: ['VITE_', 'TAURI_'],
    server: {
      strictPort: true,
      hmr: {
        protocol: 'ws',
        host: 'localhost',
        port: 1421
      },
      watch: {
        ignored: ['**/src-tauri/**']
      }
    },
    optimizeDeps: {
      include: ['@tauri-apps/api']
    }
  },

  // TypeScript設定
  typescript: {
    strict: true,
    typeCheck: true,
    tsConfig: {
      compilerOptions: {
        moduleResolution: 'bundler',
        types: ['@tauri-apps/api']
      }
    }
  },

  // 開発ツール
  devtools: { enabled: true },

  // Tauri使用時は不要な機能を無効化
  experimental: {
    payloadExtraction: false,
    renderJsonPayloads: false
  }
})
```

#### 3.4.5 確認事項

- [ ] Nuxtがインストールされたか
- [ ] `nuxt.config.ts`が作成されたか
- [ ] 設定ファイルにシンタックスエラーがないか

#### 3.4.6 成果物

- ✅ インストールされたNuxt
- ✅ `nuxt.config.ts`

---

### 3.5 タスク1.5b.1.5: Nuxt UI v4インストール

#### 3.5.1 目的

Nuxt UIコンポーネントライブラリをインストールし、設定する。

**注意**: Nuxt UI v4はまだリリースされていない可能性があります。最新の安定版Nuxt UI v3を使用します。

#### 3.5.2 インストールする依存関係

```json
{
  "dependencies": {
    "@nuxt/ui": "^3.0.0",
    "@nuxt/icon": "^1.8.0"
  }
}
```

#### 3.5.3 実装手順

```bash
# Nuxt UIをインストール
npm install @nuxt/ui@^3.0.0

# Nuxt Iconをインストール（Nuxt UIが依存）
npm install @nuxt/icon@^1.8.0
```

#### 3.5.4 nuxt.config.ts更新

```typescript
export default defineNuxtConfig({
  // ... 既存設定 ...

  // モジュール追加
  modules: [
    '@nuxt/ui',
    '@nuxt/icon'
  ]
})
```

#### 3.5.5 確認事項

- [ ] Nuxt UIがインストールされたか
- [ ] `nuxt.config.ts`にモジュールが追加されたか

#### 3.5.6 成果物

- ✅ インストールされたNuxt UI
- ✅ 更新された`nuxt.config.ts`

---

### 3.6 タスク1.5b.1.6: Tailwind CSS v4設定

#### 3.6.1 目的

Tailwind CSS v4をインストールし、カスタム設定を行う。

**注意**: Tailwind CSS v4はアルファ版です。安定版のv3.4を使用します。

#### 3.6.2 インストールする依存関係

```json
{
  "devDependencies": {
    "@nuxtjs/tailwindcss": "^6.12.0",
    "tailwindcss": "^3.4.0"
  }
}
```

#### 3.6.3 実装手順

```bash
# Tailwind CSSをインストール
npm install -D @nuxtjs/tailwindcss@^6.12.0 tailwindcss@^3.4.0
```

#### 3.6.4 nuxt.config.ts更新

```typescript
export default defineNuxtConfig({
  // ... 既存設定 ...

  modules: [
    '@nuxt/ui',
    '@nuxt/icon',
    '@nuxtjs/tailwindcss'  // 追加
  ],

  // Tailwind設定
  tailwindcss: {
    configPath: '~/tailwind.config.ts'
  }
})
```

#### 3.6.5 tailwind.config.ts作成

```typescript
import type { Config } from 'tailwindcss'

export default {
  content: [
    './app/**/*.{vue,js,ts}'
  ],
  theme: {
    extend: {
      // 環境別カラーパレット
      colors: {
        development: {
          50: '#F1F8E9',
          100: '#DCEDC8',
          200: '#C5E1A5',
          300: '#AED581',
          400: '#9CCC65',
          500: '#4CAF50',  // Primary
          600: '#43A047',
          700: '#388E3C',
          800: '#2E7D32',
          900: '#1B5E20'
        },
        test: {
          50: '#E3F2FD',
          100: '#BBDEFB',
          200: '#90CAF9',
          300: '#64B5F6',
          400: '#42A5F5',
          500: '#2196F3',  // Primary
          600: '#1E88E5',
          700: '#1976D2',
          800: '#1565C0',
          900: '#0D47A1'
        },
        staging: {
          50: '#FFF3E0',
          100: '#FFE0B2',
          200: '#FFCC80',
          300: '#FFB74D',
          400: '#FFA726',
          500: '#FF9800',  // Primary
          600: '#FB8C00',
          700: '#F57C00',
          800: '#EF6C00',
          900: '#E65100'
        },
        production: {
          50: '#FFEBEE',
          100: '#FFCDD2',
          200: '#EF9A9A',
          300: '#E57373',
          400: '#EF5350',
          500: '#F44336',  // Primary
          600: '#E53935',
          700: '#D32F2F',
          800: '#C62828',
          900: '#B71C1C'
        }
      }
    }
  }
} satisfies Config
```

#### 3.6.6 確認事項

- [ ] Tailwind CSSがインストールされたか
- [ ] `tailwind.config.ts`が作成されたか
- [ ] 環境別カラーが定義されたか

#### 3.6.7 成果物

- ✅ インストールされたTailwind CSS
- ✅ `tailwind.config.ts`

---

### 3.7 タスク1.5b.1.7: 環境別カラーパレット定義

#### 3.7.1 目的

Tailwind CSSのユーティリティクラスとして環境別のスタイルを定義する。

#### 3.7.2 実装手順

**`app/assets/css/tailwind.css`作成**:

```bash
mkdir -p app/assets/css
```

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply font-sans antialiased;
  }
}

@layer utilities {
  /* 環境別ユーティリティクラス */
  .env-development {
    @apply bg-development-50 border-development-500 border-2;
  }

  .env-development-dark {
    @apply dark:bg-development-900 dark:border-development-400;
  }

  .env-test {
    @apply bg-test-50 border-test-500 border-2;
  }

  .env-test-dark {
    @apply dark:bg-test-900 dark:border-test-400;
  }

  .env-staging {
    @apply bg-staging-50 border-staging-500 border-2;
  }

  .env-staging-dark {
    @apply dark:bg-staging-900 dark:border-staging-400;
  }

  .env-production {
    @apply bg-production-50 border-production-500 border-4;
  }

  .env-production-dark {
    @apply dark:bg-production-900 dark:border-production-400 dark:border-4;
  }
}

@layer components {
  /* 環境別コンポーネントスタイル */
  .env-badge {
    @apply px-3 py-1 rounded-full text-sm font-semibold;
  }

  .env-badge-development {
    @apply bg-development-500 text-white;
  }

  .env-badge-test {
    @apply bg-test-500 text-white;
  }

  .env-badge-staging {
    @apply bg-staging-500 text-white;
  }

  .env-badge-production {
    @apply bg-production-500 text-white;
  }
}
```

#### 3.7.3 確認事項

- [ ] `app/assets/css/tailwind.css`が作成されたか
- [ ] 4環境のユーティリティクラスが定義されたか
- [ ] ダークモード対応のクラスが含まれているか

#### 3.7.4 成果物

- ✅ `app/assets/css/tailwind.css`

---

### 3.8 タスク1.5b.1.8: app.config.ts作成

#### 3.8.1 目的

Nuxt UIのアプリケーション設定ファイルを作成し、環境別カラーを設定する。

#### 3.8.2 実装手順

**`app/app.config.ts`作成**:

```typescript
export default defineAppConfig({
  ui: {
    primary: 'green',  // デフォルト: 開発環境

    // 環境別カラーパレット
    colors: {
      development: {
        50: '#F1F8E9',
        100: '#DCEDC8',
        200: '#C5E1A5',
        300: '#AED581',
        400: '#9CCC65',
        500: '#4CAF50',
        600: '#43A047',
        700: '#388E3C',
        800: '#2E7D32',
        900: '#1B5E20'
      },
      test: {
        50: '#E3F2FD',
        100: '#BBDEFB',
        200: '#90CAF9',
        300: '#64B5F6',
        400: '#42A5F5',
        500: '#2196F3',
        600: '#1E88E5',
        700: '#1976D2',
        800: '#1565C0',
        900: '#0D47A1'
      },
      staging: {
        50: '#FFF3E0',
        100: '#FFE0B2',
        200: '#FFCC80',
        300: '#FFB74D',
        400: '#FFA726',
        500: '#FF9800',
        600: '#FB8C00',
        700: '#F57C00',
        800: '#EF6C00',
        900: '#E65100'
      },
      production: {
        50: '#FFEBEE',
        100: '#FFCDD2',
        200: '#EF9A9A',
        300: '#E57373',
        400: '#EF5350',
        500: '#F44336',
        600: '#E53935',
        700: '#D32F2F',
        800: '#C62828',
        900: '#B71C1C'
      }
    }
  }
})
```

#### 3.8.3 確認事項

- [ ] `app/app.config.ts`が作成されたか
- [ ] Nuxt UIのカラー設定が含まれているか

#### 3.8.4 成果物

- ✅ `app/app.config.ts`

---

### 3.9 タスク1.5b.1.9: app.vue作成

#### 3.9.1 目的

Nuxtアプリケーションのルートコンポーネントを作成する。

#### 3.9.2 実装手順

**`app/app.vue`作成**:

```vue
<script setup lang="ts">
import '~/assets/css/tailwind.css'

// ページタイトル設定
useHead({
  title: 'SQL Query Build',
  meta: [
    { name: 'description', content: 'Visual SQL Query Builder for Multiple Environments' }
  ]
})
</script>

<template>
  <div id="app">
    <NuxtPage />
  </div>
</template>

<style>
/* グローバルスタイル */
html, body, #app {
  height: 100%;
  margin: 0;
  padding: 0;
}
</style>
```

#### 3.9.3 確認事項

- [ ] `app/app.vue`が作成されたか
- [ ] Tailwind CSSがインポートされているか
- [ ] `<NuxtPage />`が含まれているか

#### 3.9.4 成果物

- ✅ `app/app.vue`

---

### 3.10 タスク1.5b.1.10: 動作確認ページ作成

#### 3.10.1 目的

Nuxt環境が正しく構築されたことを確認するためのページを作成する。

#### 3.10.2 実装手順

**`app/pages/index.vue`作成**:

```bash
mkdir -p app/pages
```

```vue
<script setup lang="ts">
const colorMode = useColorMode()

// 環境カラーのデモデータ
const environments = [
  { name: '開発環境', key: 'development', class: 'env-development' },
  { name: 'テスト環境', key: 'test', class: 'env-test' },
  { name: 'ステージング環境', key: 'staging', class: 'env-staging' },
  { name: '本番環境', key: 'production', class: 'env-production' }
]

const toggleColorMode = () => {
  colorMode.preference = colorMode.value === 'dark' ? 'light' : 'dark'
}
</script>

<template>
  <div class="min-h-screen p-8 bg-gray-50 dark:bg-gray-900">
    <div class="max-w-4xl mx-auto">
      <div class="mb-8">
        <h1 class="text-4xl font-bold mb-2 text-gray-900 dark:text-white">
          SQL Query Build
        </h1>
        <p class="text-xl text-gray-600 dark:text-gray-300">
          Nuxt + Nuxt UI 動作確認ページ
        </p>
      </div>

      <!-- ダークモード切り替え -->
      <UCard class="mb-8">
        <template #header>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-semibold">カラーモード</h2>
            <UButton
              :icon="colorMode.value === 'dark' ? 'i-heroicons-moon' : 'i-heroicons-sun'"
              @click="toggleColorMode"
            >
              {{ colorMode.value === 'dark' ? 'ライト' : 'ダーク' }}モードに切り替え
            </UButton>
          </div>
        </template>
        <p class="text-gray-600 dark:text-gray-300">
          現在: <strong>{{ colorMode.value }}</strong> モード
        </p>
      </UCard>

      <!-- 環境カラーテスト -->
      <UCard>
        <template #header>
          <h2 class="text-xl font-semibold">環境別カラーテスト</h2>
        </template>

        <div class="space-y-4">
          <div
            v-for="env in environments"
            :key="env.key"
            :class="[env.class, 'p-4 rounded']"
          >
            <p class="font-bold text-lg" :class="`text-${env.key}-900`">
              {{ env.name }}
            </p>
            <p class="text-sm mt-2">
              クラス: <code class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">{{ env.class }}</code>
            </p>
          </div>
        </div>

        <template #footer>
          <div class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
            <p>✅ Nuxt開発サーバーが正常に動作しています</p>
            <p>✅ Nuxt UIコンポーネントが利用可能です</p>
            <p>✅ Tailwind CSSが適用されています</p>
            <p>✅ 環境別カラーパレットが定義されています</p>
          </div>
        </template>
      </UCard>

      <!-- システム情報 -->
      <UCard class="mt-8">
        <template #header>
          <h2 class="text-xl font-semibold">システム情報</h2>
        </template>

        <div class="grid grid-cols-2 gap-4 text-sm">
          <div>
            <p class="font-semibold text-gray-700 dark:text-gray-300">フレームワーク</p>
            <p class="text-gray-600 dark:text-gray-400">Nuxt 3</p>
          </div>
          <div>
            <p class="font-semibold text-gray-700 dark:text-gray-300">UIライブラリ</p>
            <p class="text-gray-600 dark:text-gray-400">Nuxt UI v3</p>
          </div>
          <div>
            <p class="font-semibold text-gray-700 dark:text-gray-300">CSSフレームワーク</p>
            <p class="text-gray-600 dark:text-gray-400">Tailwind CSS v3.4</p>
          </div>
          <div>
            <p class="font-semibold text-gray-700 dark:text-gray-300">ランタイム</p>
            <p class="text-gray-600 dark:text-gray-400">Tauri v2</p>
          </div>
        </div>
      </UCard>
    </div>
  </div>
</template>
```

#### 3.10.3 確認事項

- [ ] `app/pages/index.vue`が作成されたか
- [ ] 4環境のカラーが表示されるか
- [ ] ダークモード切り替えボタンが実装されているか

#### 3.10.4 成果物

- ✅ `app/pages/index.vue`

---

### 3.11 タスク1.5b.1.11: Tauri設定の微調整

#### 3.11.1 目的

TauriがNuxtのビルド出力を正しく読み込むように設定を調整する。

#### 3.11.2 実装手順

**`src-tauri/tauri.conf.json`確認・更新**:

```json
{
  "build": {
    "beforeDevCommand": "npm run dev",
    "devUrl": "http://localhost:1420",
    "beforeBuildCommand": "npm run build",
    "frontendDist": "../.output/public"
  }
}
```

**`package.json`のスクリプト更新**:

```json
{
  "scripts": {
    "dev": "nuxt dev",
    "build": "nuxt build",
    "generate": "nuxt generate",
    "preview": "nuxt preview",
    "postinstall": "nuxt prepare",
    "tauri": "tauri",
    "tauri:dev": "tauri dev",
    "tauri:build": "tauri build",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "typecheck": "nuxt typecheck"
  }
}
```

#### 3.11.3 確認事項

- [ ] `src-tauri/tauri.conf.json`の`frontendDist`が正しいか
- [ ] `package.json`のスクリプトが更新されたか

#### 3.11.4 成果物

- ✅ 更新された`src-tauri/tauri.conf.json`
- ✅ 更新された`package.json`

---

### 3.12 タスク1.5b.1.12: Phase 1動作確認

#### 3.12.1 目的

Phase 1で構築した環境が正常に動作することを確認する。

#### 3.12.2 確認手順

**1. Nuxt開発サーバー起動**:

```bash
npm run dev
```

**確認項目**:
- [ ] サーバーが`http://localhost:1420`で起動する
- [ ] ブラウザで動作確認ページが表示される
- [ ] 環境カラーが正しく表示される
- [ ] ダークモード切り替えが動作する
- [ ] コンソールにエラーがない

**2. Tauriアプリ起動**:

```bash
npm run tauri:dev
```

**確認項目**:
- [ ] Tauriウィンドウが開く
- [ ] Nuxtページが表示される
- [ ] 環境カラーが正しく表示される
- [ ] ダークモード切り替えが動作する
- [ ] ターミナルにエラーがない

**3. ビルドテスト**:

```bash
npm run build
```

**確認項目**:
- [ ] ビルドが成功する
- [ ] `.output/public/`ディレクトリが作成される
- [ ] エラーがない

**4. 型チェック**:

```bash
npm run typecheck
```

**確認項目**:
- [ ] 型チェックが成功する
- [ ] TypeScriptエラーがない

#### 3.12.3 トラブルシューティング

##### 問題: ポート1420が使用中

```bash
# ポートを使用しているプロセスを確認
lsof -i :1420

# プロセスを終了
kill -9 <PID>
```

##### 問題: Tailwind CSSが適用されない

```bash
# キャッシュをクリア
rm -rf .nuxt node_modules/.cache
npm run dev
```

##### 問題: 型エラーが発生

```bash
# 型を再生成
npm run postinstall
```

#### 3.12.4 成果物

- ✅ 動作確認済みのNuxt開発環境
- ✅ Tauri統合動作確認
- ✅ Phase 1完了レポート

---

## 4. 技術仕様

### 4.1 開発環境

| 項目 | バージョン | 備考 |
|------|----------|------|
| Node.js | v20.x以上 | LTS推奨 |
| npm | v10.x以上 | Node.js付属 |
| Rust | 1.70以上 | Tauri要件 |
| Tauri CLI | v2.2.0 | インストール済み |

### 4.2 フレームワーク・ライブラリ

| 項目 | バージョン | 用途 |
|------|----------|------|
| Nuxt | ^3.15.0 | フレームワーク |
| Vue | ^3.5.13 | UIフレームワーク |
| Nuxt UI | ^3.0.0 | UIコンポーネント |
| Tailwind CSS | ^3.4.0 | スタイリング |
| TypeScript | ~5.7.2 | 型システム |
| Tauri API | ^2.2.0 | Rust IPC |

### 4.3 ディレクトリ構造

```
/
├── app/                        # Nuxtアプリケーション
│   ├── assets/
│   │   └── css/
│   │       └── tailwind.css   # グローバルCSS
│   ├── pages/
│   │   └── index.vue          # 動作確認ページ
│   ├── app.vue                # ルートコンポーネント
│   └── app.config.ts          # Nuxt UI設定
├── src-tauri/                  # Tauriバックエンド（変更なし）
├── docs/                       # ドキュメント
├── nuxt.config.ts             # Nuxt設定
├── tailwind.config.ts         # Tailwind設定
└── package.json
```

### 4.4 ポート設定

| サービス | ポート | 用途 |
|---------|--------|------|
| Nuxt Dev Server | 1420 | フロントエンド開発サーバー |
| Vite HMR | 1421 | ホットモジュールリプレースメント |

### 4.5 環境別カラーパレット

| 環境 | Primary Color | 用途 |
|------|--------------|------|
| 開発 (Development) | `#4CAF50` (Green) | 開発環境識別 |
| テスト (Test) | `#2196F3` (Blue) | テスト環境識別 |
| ステージング (Staging) | `#FF9800` (Orange) | ステージング環境識別 |
| 本番 (Production) | `#F44336` (Red) | 本番環境識別（注意喚起） |

---

## 5. 依存関係とリスク

### 5.1 タスク依存関係

```
1.5b.1.1 (バックアップ)
  ↓
1.5b.1.2 (ブランチ作成)
  ↓
1.5b.1.3 (削除・クリーンアップ)
  ↓
1.5b.1.4 (Nuxtインストール)
  ↓
1.5b.1.5 (Nuxt UIインストール)
  ↓
1.5b.1.6 (Tailwindインストール)
  ↓
1.5b.1.7 (カラーパレット定義)
  ↓
1.5b.1.8 (app.config.ts作成)
  ↓
1.5b.1.9 (app.vue作成)
  ↓
1.5b.1.10 (動作確認ページ作成)
  ↓
1.5b.1.11 (Tauri設定調整)
  ↓
1.5b.1.12 (動作確認)
```

### 5.2 リスクと対策

| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|---------|------|
| Nuxt/Tauri統合の不具合 | 高 | 低 | Phase 1で早期検証、既知の設定を使用 |
| 依存関係のバージョン競合 | 中 | 中 | package-lock.jsonで固定、バージョン範囲を慎重に設定 |
| ポート競合 | 低 | 中 | プロセス確認手順を用意、代替ポート設定可能 |
| Tailwind CSSの未適用 | 中 | 低 | 設定の二重確認、キャッシュクリア手順準備 |
| 既存コード削除の誤り | 高 | 低 | バックアップブランチ作成、削除前の確認 |

### 5.3 ブロッカー

| ブロッカー | 対処法 |
|-----------|--------|
| Rustがインストールされていない | [公式サイト](https://www.rust-lang.org/)からインストール |
| Node.jsバージョンが古い | nvmで最新LTS版をインストール |
| Tauri CLIがない | `cargo install tauri-cli --version ^2.0.0` |

---

## 6. 検証・テスト計画

### 6.1 単体テスト

| テスト項目 | 期待結果 | 確認方法 |
|-----------|---------|---------|
| Nuxt開発サーバー起動 | サーバーが1420ポートで起動 | `npm run dev`実行 |
| 環境カラー表示 | 4環境のカラーが正しく表示 | ブラウザで確認 |
| ダークモード切り替え | ライト/ダークが切り替わる | ボタンクリック |
| Tailwind CSSの適用 | スタイルが正しく適用される | デベロッパーツールで確認 |
| TypeScript型チェック | エラーなし | `npm run typecheck` |

### 6.2 統合テスト

| テスト項目 | 期待結果 | 確認方法 |
|-----------|---------|---------|
| Tauri起動 | ウィンドウが開き、Nuxtページが表示 | `npm run tauri:dev`実行 |
| Tauri IPC準備 | `window.__TAURI__`が利用可能 | コンソールで確認 |
| ビルド成功 | `.output/public/`が生成される | `npm run build`実行 |

### 6.3 性能テスト

| 項目 | 目標値 | 測定方法 |
|------|-------|---------|
| 開発サーバー起動時間 | < 5秒 | 時間計測 |
| 初期ロード時間 | < 2秒 | ブラウザのパフォーマンスタブ |
| HMR反映時間 | < 1秒 | ファイル変更後の反映確認 |

### 6.4 受け入れテスト

| テスト項目 | 合格基準 |
|-----------|---------|
| 全機能動作 | すべての確認項目をクリア |
| エラーなし | コンソール、ターミナルにエラーなし |
| ドキュメント完成 | 成果物がすべて揃っている |
| チーム承認 | プロジェクトリードの承認取得 |

---

## 7. 成果物チェックリスト

### 7.1 コードファイル

- [ ] `nuxt.config.ts` - Nuxt設定ファイル
- [ ] `tailwind.config.ts` - Tailwind設定ファイル
- [ ] `app/app.config.ts` - Nuxt UI設定ファイル
- [ ] `app/app.vue` - ルートコンポーネント
- [ ] `app/assets/css/tailwind.css` - グローバルCSS
- [ ] `app/pages/index.vue` - 動作確認ページ

### 7.2 設定ファイル

- [ ] `package.json` - 更新された依存関係とスクリプト
- [ ] `src-tauri/tauri.conf.json` - Tauri設定調整
- [ ] `.gitignore` - Nuxt関連の追加

### 7.3 ブランチ

- [ ] `backup/vue-vuetify-implementation` - バックアップブランチ
- [ ] `feature/nuxt-fresh-start-20251212` - 移行作業ブランチ

### 7.4 ドキュメント

- [ ] Phase 1詳細設計書（本ドキュメント）
- [ ] Phase 1完了レポート
- [ ] トラブルシューティングガイド

### 7.5 検証結果

- [ ] Nuxt開発サーバー動作確認完了
- [ ] Tauriアプリ起動確認完了
- [ ] 環境カラー表示確認完了
- [ ] ダークモード動作確認完了
- [ ] ビルド成功確認完了
- [ ] 型チェック成功確認完了

---

## 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|-------|------|
| プロジェクトマネージャー | | | |
| 技術リード | | | |
| QAリード | | | |

---

## 変更履歴

| バージョン | 日付 | 変更内容 | 作成者 |
|----------|------|---------|--------|
| 1.0 | 2025-12-12 | 初版作成 | Claude |

---

**次のアクション**:
1. 本設計書のレビュー・承認
2. タスク1.5b.1.1から順次実装開始
3. 完了後、Phase 2の設計書作成へ進む
